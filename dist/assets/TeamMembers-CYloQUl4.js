import{j as e,r as p,a as ce}from"./index-Dvb9ohnK.js";import{i as he,s as M,a as D,P as pe}from"./Paper-DbN--PaP.js";import{r as ue,P as u,M as q,B as f,T as I,G as y,a as v,b as E,c as xe,u as _,I as me,A as ge,d as je,e as be,f as T,g as fe,h as ye,i as Ce,j as ve,k as ke,l as W,m as i,n as Se,o as we,p as Ee,q as Pe,s as F,t as $,v as O,w as U,x as Re,F as Le}from"./FileSaver.min-BL61B1Cf.js";import{I as k,u as De}from"./IconButton-BQi0Jw9M.js";var A={},Te=he;Object.defineProperty(A,"__esModule",{value:!0});var H=A.default=void 0,We=Te(ue()),_e=e;H=A.default=(0,We.default)((0,_e.jsx)("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");const Ie={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:600,maxHeight:"90%",overflow:"hidden",bgcolor:"background.paper",boxShadow:24,p:4},z=({open:t,handleClose:l,handleSave:d,employee:r})=>{const[s,h]=p.useState({...r});p.useEffect(()=>{h({...r})},[r]);const n=m=>{const{name:j,value:o}=m.target;h(c=>({...c,[j]:o}))},x=m=>{m.preventDefault(),d(s)};return e.jsx(q,{open:t,onClose:l,"aria-labelledby":"edit-employee-modal","aria-describedby":"edit-employee-modal-description",children:e.jsxs(f,{sx:Ie,component:"form",onSubmit:x,children:[e.jsx(I,{id:"edit-employee-modal",variant:"h6",component:"h2",children:"Edit Employee"}),e.jsxs(y,{container:!0,spacing:2,children:[e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"Name",name:"Name",value:s.Name,onChange:n,fullWidth:!0,margin:"normal"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"Grade",name:"Grade",value:s.Grade,onChange:n,fullWidth:!0,margin:"normal"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"Designation",name:"Designation",value:s.Designation,onChange:n,fullWidth:!0,margin:"normal"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"Project",name:"Project",value:s.Project,onChange:n,fullWidth:!0,margin:"normal"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"Skills",name:"Skills",value:s.Skills,onChange:n,fullWidth:!0,margin:"normal"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"Location",name:"Location",value:s.Location,onChange:n,fullWidth:!0,margin:"normal"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:"ContactNo",name:"ContactNo",value:s.ContactNo,onChange:n,fullWidth:!0,margin:"normal"})})]}),e.jsxs(f,{sx:{mt:2,display:"flex",gap:2,justifyContent:"right"},children:[e.jsx(E,{type:"submit",variant:"contained",color:"primary",children:"Save"}),e.jsx(E,{onClick:l,variant:"contained",color:"secondary",children:"Cancel"})]})]})})};z.propTypes={open:u.bool.isRequired,handleClose:u.func.isRequired,handleSave:u.func.isRequired,employee:u.object.isRequired};const Me={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:600,maxHeight:"90vh",overflowY:"auto",bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2},G={EmpId:"",Name:"",Grade:"",Designation:"",Project:"",Skills:"",Location:"",ContactNo:""},Y=({open:t,handleClose:l,handleSave:d})=>{const[r,s]=p.useState(G),[h,n]=p.useState({});p.useEffect(()=>{t||(s(G),n({}))},[t]);const x=o=>{const{name:c,value:P}=o.target;let S=P;c==="ContactNo"&&(S=S.replace(/\D/g,"")),s(R=>({...R,[c]:S.trimStart()})),n(R=>({...R,[c]:""}))},m=()=>{const o={};return Object.keys(r).forEach(c=>{r[c]||(o[c]=`${c} is required`)}),n(o),Object.keys(o).length===0},j=o=>{o.preventDefault(),m()&&(d(r),l())};return e.jsx(q,{open:t,onClose:l,"aria-labelledby":"add-employee-modal","aria-describedby":"add-employee-modal-description",children:e.jsxs(f,{sx:Me,component:"form",onSubmit:j,children:[e.jsx(I,{id:"add-employee-modal",variant:"h6",mb:2,children:"Add Employee"}),e.jsx(y,{container:!0,spacing:2,children:Object.entries(r).map(([o,c])=>e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(v,{label:o,name:o,value:c,onChange:x,fullWidth:!0,margin:"dense",required:!0,error:!!h[o],helperText:h[o]})},o))}),e.jsxs(f,{sx:{mt:3,display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(E,{type:"submit",variant:"contained",color:"primary",children:"Save"}),e.jsx(E,{onClick:l,variant:"outlined",color:"secondary",children:"Cancel"})]})]})})};Y.propTypes={open:u.bool.isRequired,handleClose:u.func.isRequired,handleSave:u.func.isRequired};const qe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4},V=({open:t,handleClose:l,handleSave:d})=>{const[r,s]=p.useState(null),h=x=>{s(x.target.files[0])},n=()=>{if(r){const x=new FileReader;x.onload=m=>{const j=new Uint8Array(m.target.result),o=xe(j,{type:"array"}),c=o.Sheets[o.SheetNames[0]],P=_.sheet_to_json(c);d(P)},x.readAsArrayBuffer(r)}l()};return e.jsx(q,{open:t,onClose:l,"aria-labelledby":"upload-modal-title","aria-describedby":"upload-modal-description",children:e.jsxs(f,{sx:qe,children:[e.jsx(I,{id:"upload-modal-title",variant:"h6",component:"h2",children:"Upload Employee Data"}),e.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:h}),e.jsxs(f,{sx:{display:"flex",gap:2,justifyContent:"right",mt:2},children:[e.jsx(E,{variant:"contained",color:"primary",onClick:n,children:"Upload"}),e.jsx(E,{variant:"contained",color:"secondary",onClick:l,children:"Cancel"})]})]})})};V.propTypes={open:u.bool.isRequired,handleClose:u.func.isRequired,handleSave:u.func.isRequired};const Ae=M("div")(({theme:t})=>({position:"relative",borderRadius:t.shape.borderRadius,backgroundColor:t.palette.grey[200],"&:hover":{backgroundColor:t.palette.grey[300]},marginRight:t.spacing(2),marginLeft:t.spacing(2),width:"100%",[t.breakpoints.up("sm")]:{marginLeft:t.spacing(2),width:"auto"}})),Ne=M("div")(({theme:t})=>({padding:t.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",color:t.palette.text.primary})),Be=M(me)(({theme:t})=>({color:"inherit","& .MuiInputBase-input":{padding:t.spacing(1,1,1,0),paddingLeft:`calc(1em + ${t.spacing(4)})`,transition:t.transitions.create("width"),width:"100%",[t.breakpoints.up("md")]:{width:"20ch"}}}));function J(t){const l=De(),{count:d,page:r,rowsPerPage:s,onPageChange:h}=t,n=o=>{h(o,0)},x=o=>{h(o,r-1)},m=o=>{h(o,r+1)},j=o=>{h(o,Math.max(0,Math.ceil(d/s)-1))};return e.jsxs(f,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(k,{onClick:n,disabled:r===0,"aria-label":"first page",children:l.direction==="rtl"?e.jsx(F,{}):e.jsx($,{})}),e.jsx(k,{onClick:x,disabled:r===0,"aria-label":"previous page",children:l.direction==="rtl"?e.jsx(O,{}):e.jsx(U,{})}),e.jsx(k,{onClick:m,disabled:r>=Math.ceil(d/s)-1,"aria-label":"next page",children:l.direction==="rtl"?e.jsx(U,{}):e.jsx(O,{})}),e.jsx(k,{onClick:j,disabled:r>=Math.ceil(d/s)-1,"aria-label":"last page",children:l.direction==="rtl"?e.jsx($,{}):e.jsx(F,{})})]})}J.propTypes={count:u.number.isRequired,onPageChange:u.func.isRequired,page:u.number.isRequired,rowsPerPage:u.number.isRequired};const Fe=()=>{const[t,l]=p.useState([]),[d,r]=p.useState(""),[s,h]=p.useState(0),[n,x]=p.useState(5),[m,j]=p.useState(!1),[o,c]=p.useState(!1),[P,S]=p.useState(!1),[R,K]=p.useState({}),{userRole:w,userEmpId:N}=ce();p.useEffect(()=>{D.get("http://localhost:8000/employeesData").then(a=>{l(a.data)}).catch(a=>{console.error("Error fetching data: ",a)})},[]);const Q=a=>{if(w==="viewer"&&a.EmpId!==N){alert("You can only edit your own data.");return}K(a),j(!0)},X=a=>{D.put(`http://localhost:8000/employeesData/${a.id}`,a).then(g=>{l(b=>b.map(C=>C.id===a.id?g.data:C)),j(!1)}).catch(g=>{console.error("Error updating data: ",g),alert("Failed to update employee. Please try again.")})},Z=()=>{j(!1)},ee=()=>{c(!0)},ae=a=>{const g={...a,id:Date.now()};D.post("http://localhost:8000/employeesData",g).then(b=>{l(C=>[...C,b.data]),c(!1)}).catch(b=>{console.error("Error adding data: ",b),alert("Failed to add employee. Please try again.")})},te=()=>{c(!1)},oe=()=>{S(!0)},se=a=>{a.forEach(g=>{D.post("http://localhost:8000/employeesData",g).then(b=>{l(C=>[...C,b.data])}).catch(b=>{console.error("Error adding data from upload: ",b),alert("Failed to upload employee data. Please try again.")})}),S(!1)},ne=()=>{S(!1)},le=a=>{r(a.target.value)},re=()=>{const a=_.json_to_sheet(t),g=_.book_new();_.book_append_sheet(g,a,"Employees");const b=Re(g,{bookType:"xlsx",type:"array"}),C=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Le.saveAs(C,"employees_data.xlsx")},L=t.filter(a=>a.Name.toLowerCase().includes(d.toLowerCase())||a.Grade.toLowerCase().includes(d.toLowerCase())||a.Designation.toLowerCase().includes(d.toLowerCase())||a.Project.toLowerCase().includes(d.toLowerCase())||a.Skills.toLowerCase().includes(d.toLowerCase())||a.Location.toLowerCase().includes(d.toLowerCase())||a.ContactNo.toLowerCase().includes(d.toLowerCase())),B=s>0?Math.max(0,(1+s)*n-L.length):0,ie=(a,g)=>{h(g)},de=a=>{x(parseInt(a.target.value,10)),h(0)};return e.jsxs(f,{sx:{paddingRight:10,paddingLeft:10},children:[e.jsx(ge,{position:"static",sx:{backgroundColor:"var(--lt-color-gray-400)"},children:e.jsxs(je,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(I,{variant:"inherit",noWrap:!0,sx:{color:"black",display:{xs:"none",sm:"block"}},children:"Employee"}),e.jsxs(Ae,{children:[e.jsx(Ne,{children:e.jsx(be,{})}),e.jsx(Be,{placeholder:"Searchâ€¦",inputProps:{"aria-label":"search",style:{color:"black"}},value:d,onChange:le})]})]}),e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[w==="admin"&&e.jsxs(e.Fragment,{children:[e.jsx(T,{title:"Add Employee",children:e.jsx(k,{onClick:ee,sx:{backgroundColor:"blue",color:"white","&:hover":{backgroundColor:"darkblue"},marginRight:"8px"},children:e.jsx(fe,{})})}),e.jsx(T,{title:"Upload Employee List",children:e.jsx(k,{onClick:oe,sx:{backgroundColor:"red",color:"white","&:hover":{backgroundColor:"darkred"},marginRight:"8px"},children:e.jsx(H,{})})})]}),(w==="admin"||w==="manager"||w==="viewer")&&e.jsx(T,{title:"Download Employee List",children:e.jsx(k,{onClick:re,sx:{backgroundColor:"green",color:"white","&:hover":{backgroundColor:"darkgreen"}},children:e.jsx(ye,{})})})]})]})}),e.jsx(Ce,{component:pe,children:e.jsxs(ve,{sx:{minWidth:500},"aria-label":"custom pagination table",children:[e.jsx(ke,{children:e.jsxs(W,{children:[e.jsx(i,{sx:{fontWeight:"bold"},children:"EmpID"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Name"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Grade"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Designation"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Project"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Skills"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Location"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"ContactNo"}),e.jsx(i,{sx:{fontWeight:"bold"},children:"Actions"})]})}),e.jsxs(Se,{children:[(n>0?L.slice(s*n,s*n+n):L).map(a=>e.jsxs(W,{children:[e.jsx(i,{component:"th",scope:"row",children:a.EmpId}),e.jsx(i,{children:a.Name}),e.jsx(i,{children:a.Grade}),e.jsx(i,{children:a.Designation}),e.jsx(i,{children:a.Project}),e.jsx(i,{children:a.Skills}),e.jsx(i,{children:a.Location}),e.jsx(i,{children:a.ContactNo}),e.jsx(i,{children:e.jsx(f,{sx:{display:"flex",alignItems:"center"},children:e.jsx(T,{title:"Edit Employee List",children:e.jsx(k,{sx:{color:"blue","&:hover":{color:"darkblue"}},onClick:()=>Q(a),disabled:w==="viewer"&&a.EmpId!==N,children:e.jsx(we,{})})})})})]},a.EmpId)),B>0&&e.jsx(W,{style:{height:53*B},children:e.jsx(i,{colSpan:9})})]}),e.jsx(Ee,{children:e.jsx(W,{children:e.jsx(Pe,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:9,count:L.length,rowsPerPage:n,page:s,slotProps:{select:{inputProps:{"aria-label":"rows per page"},native:!0}},onPageChange:ie,onRowsPerPageChange:de,ActionsComponent:J})})})]})}),m&&e.jsx(z,{open:m,handleClose:Z,employee:R,handleSave:X}),e.jsx(Y,{open:o,handleClose:te,handleSave:ae}),e.jsx(V,{open:P,handleClose:ne,handleSave:se})]})},He=()=>e.jsx("div",{children:e.jsx(Fe,{})});export{He as default};
